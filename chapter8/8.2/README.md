# 8.2 필드 옮기기

> Move Field

### 배경

프로그램의 진짜 힘은 데이터 구조에서 나온다. 주어진 문제에 적합한 데이터 구조를 선택하면 동작 코드는 자연스럽게 단순하고 직관적으로 짜여진다.  
현재 데이터 구조가 적절치 않음을 깨닫게 되면 곧바로 수정해야 한다.

### 절차

1. 소스 필드가 캡슐화되어 있지 않다면 캡슐화한다.
2. 테스트한다.
3. 타깃 객체에 필드(와 접근자 메스드들)를 생성한다.
4. 정적 검사를 수행한다.
5. 소스 객체에서 타깃 객체를 참조할 수 있는지 확인한다.  
   -> 기존 필드나 메서드 중 타깃 객체를 넘겨주는 게 있을지 모른다. 없다면 이런 기능의 메서드를 쉽게 만들 수 있는지 살펴본다. 간단치 않다면 타깃 객체를 저장할 새 필드를 소스 객체에 생성하자.  
   이는 영구적인 변경이 되겠지만, 더 넓은 맥락에서 리팩터링을 충분히 하고 나면 다시 없앨 수 있을 때도 있다.
6. 접근자들이 타깃 필드를 사용하도록 수정한다.  
   -> 여러 소스에서 같은 타깃을 공유한다면, 먼저 세터를 수정하여 타깃 필드와 소스 필드 모두를 갱신하게 하고, 이어서 일관성을 깨뜨리는 갱신을 검출할 수 있도록 어서션을 추가하자. 모든 게 잘 마무리되었다면 접근자들이 타깃 필드를 사용하도록 수정한다.
7. 테스트한다.
8. 소드 필드를 제거한다.
9. 테스트한다.

### 예시

```jsx
class Customer {
  get plan() {
    return this._plan;
  }
  get discountRate() {
    return this._discountRate;
  }
}
```

---

```jsx
class Customer {
  get plan() {
    return this._plan;
  }
  get discountRate() {
    return this.plan._discountRate;
  }
}
```
