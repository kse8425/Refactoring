# 12.11 슈퍼클래스를 위임으로 바꾸기

> Replace Superclass with Delegate

### 배경

제대로 된 상속이라면 서브클래스가 슈퍼클래스의 모든 기능을 사용함은 물론, 서브클래스의 인스턴스를 슈퍼클래스의 인스턴스로도 취급할 수 있어야 한다.  
위임을 이용하면 기능 일부만 빌려올 뿐인, 서로 별개인 개념임이 명확해진다.  
위임에도 단점이 있다. 위임의 기능을 이용할 호스트의 함수 모두를 전달 함수(_forwarding function_)로 만들어야 한다는 점이다.
상속을 절대 사용하지 말라고 조언하는 사람도 있지만 왠만하면 상속을 먼저 적용하고, 만일 나중에 문제가 생긱면 슈퍼클래스를 위임으로 바꾼다.

### 절차

1. 슈퍼클래스 객체를 참조하는 필드를 서브클래스에서 만든다(이번 리팩터링을 끝마치면 슈퍼클래스가 위임 객체가 될 것이므로 이 필드를 '위임 참조'라 부르자). 위임 참조를 새로운 슈퍼클래스 인스턴스로 초기화한다.
2. 슈퍼클래스의 동작 각각에 대응하는 전달 함수를 서브클래스에 만든다(물론 위임 참조로 전달한다). 서로 관련된 함수끼리 그룹으로 묶어 진행하며, 그룹을 하나씩 만들 때마다 테스트한다.  
   -> 대부분은 전달 함수 각각을 테스트할 수 있을 것이다. 하지만 예컨대 케터와 세터 쌍은 둘 다 옮기 후에야 테스트할 수 있다.
3. 슈퍼클래스의 동작 모두가 전달 함수로 오버라이드되었다면 상속 관계를 끊는다.

### 예시

```jsx
class List { ... }
class Stack extends List{ ... }
```

---

```jsx
class Stack {
    constructor() {
        this._storage = new List();
    }
}
class List { ... }
```
